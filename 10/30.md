
FreeBSD ä¸‹çš„è™šæ‹ŸæŠ€æœ¯ bhyve (The BSD Hypervisor) åŒ…å«åœ¨äº† FreeBSD 10.0 å‘è¡Œç‰ˆä¸­ã€‚è€Œè¿™ä¸ª xhyve æ˜¯åŸºäº bhyve çš„ Mac OS X ç§»æ¤ç‰ˆæœ¬

https://github.com/machyve/xhyve

ä½¿ç”¨ git ä¸‹è½½æºç åç¼–è¯‘ï¼Œè¿è¡Œ xhyverun.sh åä¼šå¯åŠ¨ä¸€ä¸ªç®€å•çš„ Tiny Core Linux è™šæ‹Ÿæœºï¼š

$ git clone https://github.com/mist64/xhyve.git
$ cd xhyve
$ make
$ ./xhyverun.sh

https://developer.aliyun.com/article/116675

https://cloud-atlas.readthedocs.io/zh_CN/latest/kvm/macos_xhyve/xhyve.html

https://www.kaifa99.com/GitHub/article_125375

https://medium.com/@hintcnuie/the-difference-between-xhyve-and-hyperkit-67a9f378ab97


https://github.com/moby/vpnkit

https://github.com/moby/datakit


https://www.nebulaworks.com/insights/posts/getting-started-linuxkit-mac-os-x-xhyve/

https://docs.docker.com/desktop/mac/

Docker for Mac ä¹Ÿæ˜¯åœ¨æœ¬åœ°è·‘äº†ä¸€ä¸ªè™šæ‹Ÿæœºæ¥è¿è¡Œ Dockerï¼Œä¸è¿‡ Hypervisor é‡‡ç”¨çš„æ˜¯ xhyveï¼Œè€Œ xhyve åˆåŸºäº Mac è‡ªå¸¦çš„è™šæ‹ŸåŒ–æ–¹æ¡ˆ Hypervisor.frameworkï¼Œè™šæ‹Ÿæœºé‡Œè¿è¡Œçš„å‘è¡Œç‰ˆæ˜¯ Docker è‡ªå·±æ‰“åŒ…çš„ LinuxKit

https://www.haoyizebo.com/posts/fd0b9bd8/


% brew install opam libev

 opam init
No configuration file found, using built-in defaults.
Checking for available remotes: rsync and local, git.
  - you won't be able to use mercurial repositories unless you install the hg command on your system.
  - you won't be able to use darcs repositories unless you install the darcs command on your system.


<><> Fetching repository information ><><><><><><><><><><><><><><><><><><><>  ğŸ«
Processing  1/1: [default: http]

https://github.com/linuxkit/linuxkit

https://github.com/linuxkit/kubernetes

https://blog.51cto.com/lullaby/2421309

https://tonybai.com/2021/03/23/io-fs-interface-is-an-excellent-design/


https://github.com/docker/for-mac


https://www.zhihu.com/question/40051989?sort=created

https://cleanmymac.cn/download
https://www.pagetable.com/?p=831


https://github.com/Wang-Kai/cherish-today/issues/83

https://www.zhihu.com/question/454947910/answer/1841432604


https://github.com/moby/hyperkit. âˆš


https://forums.docker.com/t/how-to-make-changes-to-xhyve-host/11820/5

https://github.com/machyve/xhyve


https://forums.docker.com/t/is-it-possible-to-ssh-to-the-xhyve-machine/17426


https://zhuanlan.zhihu.com/p/43237959

https://docs.docker.com/engine/reference/commandline/dockerd/

https://blog.csdn.net/zhangmenghao1983/article/details/82184957

https://blog.csdn.net/baidu_32656897/article/details/86504317


https://www.cnblogs.com/cag2050/p/10100899.html


https://www.dbform.com/2019/07/08/how-to-login-the-vm-of-docker-desktop-for-mac/

https://medium.com/carvago-development/my-docker-on-macos-part-1-setup-ubuntu-virtual-machine-both-intel-and-apple-silicon-cpu-5d886af0ebba

https://gist.github.com/BretFisher/5e1a0c7bcca4c735e716abf62afad389


https://www.modb.pro/db/5458

https://earthly.dev/blog/using-apple-silicon-m1-as-a-cloud-engineer-two-months-in/



2

I think the new version of docker (my version is 20.10.5) uses socket instead of TTY to communicate with the virtual machine so you can use the nc command instead of the screen command.

nc -U ~/Library/Containers/com.docker.docker/Data/debug-shell.sock


https://stackoverflow.com/questions/38532483/where-is-var-lib-docker-on-mac-os-x


?????uname -a
Linux docker-desktop 5.10.47-linuxkit #1 SMP PREEMPT Sat Jul 3 21:50:16 UTC 2021 aarch64 Linux

https://www.krenger.ch/blog/docker-desktop-for-mac-ssh-into-the-docker-vm/


https://stackoverflow.com/questions/39739560/how-to-access-the-vm-created-by-dockers-hyperkit



https://www.jianshu.com/p/ab6f8be85470



https://collabnix.com/how-docker-for-mac-works-under-the-hood/

https://collabnix.com/how-docker-for-mac-works-under-the-hood/

https://gist.github.com/retraut/1dee3d6331c4b8eeb4ef54bfdce09d62

https://wongyouth.github.io/2019/04/28/xhyve-%E8%8B%B9%E6%9E%9C%E7%94%B5%E8%84%91%E4%B8%8B%E8%BD%BB%E9%87%8F%E7%BA%A7%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%96%B9%E6%A1%88/

https://www.wavether.com/2016/09/docker-machine-xhyve-mac-os


/ # ^[[26;5Rctr version
ctr version
Client:
  Version:  v1.3.4
  Revision: 814b7956fafc7a0980ea07e950f983d0837e5578

Server:
  Version:  v1.3.4
  Revision: 814b7956fafc7a0980ea07e950f983d0837e5578
  UUID: d0bdf2c7-b3d8-45f2-be9a-ffdd6c782cc5
/ # ^[[26;5R^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@


 hyperkit % make
 
 % ./hyperkitrun.sh
~/source/hyperkit/test ~/source/hyperkit
Downloading tinycore linux


~/source/hyperkit
hv_vm_create HV_ERROR (unspecified error)
./hyperkitrun.sh: line 39: 84413 Abort trap: 6           build/hyperkit $ACPI $MEM $SMP $PCI_DEV $LPC_DEV $NET $IMG_CD $IMG_HDD $UUID -f kexec,$KERNEL,$INITRD,"$CMDLINE"


https://github.com/kubernetes/minikube/issues/10120

https://github.com/moby/hyperkit/issues/303#issuecomment-875122919



HyperKitæ˜¯ä¸€ä¸ªå…·æœ‰hyperisorèƒ½åŠ›çš„å·¥å…·é›†ï¼ŒåŒ…å«äº†åŸºäº xhyve - macOSå¹³å°çš„KVM/bhyve (è½»é‡çº§è™šæ‹Ÿæœºå’Œå®¹å™¨éƒ¨ç½²) çš„å®Œæ•´hypervisorã€‚HyperKitè®¾è®¡æˆä¸Šå±‚ç»„ä»¶è¯¸å¦‚ VPNKit å’Œ DataKit çš„æ¥å£ã€‚

æ³¨è§£

VPNKit æ˜¯ä¸€ä¸ªå·¥å…·å’ŒæœåŠ¡é›†åˆç”¨äºå¸®åŠ©HyperKitè™šæ‹Ÿæœºå’Œä¸»æœºVPNé…ç½®åä½œã€‚

DataKit æ˜¯ä¸€ä¸ªä½¿ç”¨ç±»ä¼¼Gitçš„å·¥ä½œæµæ¥ç¼–æ’åº”ç”¨ç¨‹åºçš„å·¥å…·ï¼Œå€Ÿé‰´äº†UNIXç®¡é“(pipline)æ¦‚å¿µï¼Œä½¿ç”¨äº†æ›¿ä»£åº•å±‚æ–‡æœ¬çš„æ ‘çŠ¶ç»“æ„æ•°æ®çš„æµã€‚DataKitå¯ä»¥åœ¨ç‰ˆæœ¬æ§åˆ¶æ•°æ®ä¸Šå®šä¹‰å¤æ‚çš„ç¼–è¯‘å·¥ä½œæµã€‚å½“å‰DataKitä½œä¸ºHyperKitçš„ä¸€ä¸ªå†™ä½œæµï¼Œä»¥åŠç”¨äº DataKitCI æŒç»­é›†æˆç³»ç»Ÿã€‚

è¦æ¿€æ´»å—è®¾å¤‡åç«¯æ”¯æŒqcowï¼Œå‡†å¤‡ä¸€ä¸ª OCaml OPAMå¼€å‘ç¯å¢ƒã€‚åˆ™éœ€è¦é€šè¿‡ brew å®‰è£… opam å’Œ libev ç„¶åä½¿ç”¨ opam æ¥å®‰è£…ç›¸åº”çš„åº“:

brew install opam libev
opam init
eval `opam config env`
opam install uri qcow.0.10.4 conduit.1.0.0 lwt.3.1.0 qcow-tool mirage-block-unix.2.9.0 conf-libev logs fmt mirage-unix prometheus-app


https://cloud-atlas.readthedocs.io/zh_CN/latest/docker/moby/hyperkit/run_hyperkit.html

HyperKitï¼šOSXä¸Šè¿è¡Œçš„è½»é‡çº§è™šæ‹ŸåŒ–å·¥å…·åŒ…
DataKitï¼šç°ä»£åŒ–åˆ†å¸ƒå¼ç»„ä»¶æ¡†æ¶
VPNKitï¼šåµŒå…¥å¼è™šæ‹Ÿç½‘ç»œåº“

http://dockone.io/article/1329



https://github.com/moby/hyperkit

https://minikube.sigs.k8s.io/docs/drivers/hyperkit/
